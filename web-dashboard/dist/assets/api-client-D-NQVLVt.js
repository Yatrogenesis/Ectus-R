var y=Object.defineProperty;var l=(s,e,r)=>e in s?y(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r;var i=(s,e,r)=>l(s,typeof e!="symbol"?e+"":e,r);var c={};class f{constructor(e){i(this,"baseUrl");i(this,"apiKey");i(this,"timeout");i(this,"ws");this.baseUrl=e.baseUrl||c.REACT_APP_API_URL||"https://ectus-r-saas.pako-molina.workers.dev",this.apiKey=e.apiKey||c.REACT_APP_API_KEY,this.timeout=e.timeout||3e4,console.log(`[APIClient] Initialized with baseUrl: ${this.baseUrl}`)}async request(e,r={},t=3){const o=`${this.baseUrl}${e}`,n={"Content-Type":"application/json",...r.headers};this.apiKey&&(n.Authorization=`Bearer ${this.apiKey}`);const d=new AbortController,p=setTimeout(()=>d.abort(),this.timeout);try{const a=await fetch(o,{...r,headers:n,signal:d.signal});clearTimeout(p);const h=a.status;if(!a.ok){const u=await a.text();return{error:`HTTP ${h}: ${u}`,status:h}}return{data:await a.json(),status:h}}catch(a){return clearTimeout(p),t>0&&a instanceof Error&&a.name!=="AbortError"?(await this.delay(Math.pow(2,3-t)*1e3),this.request(e,r,t-1)):{error:a instanceof Error?a.message:"Unknown error",status:0}}}delay(e){return new Promise(r=>setTimeout(r,e))}async get(e){const r=await this.request(e,{method:"GET"});if(r.error)throw new Error(r.error);if(!r.data)throw new Error("No data received");return r.data}async post(e,r){const t=await this.request(e,{method:"POST",body:r?JSON.stringify(r):void 0});if(t.error)throw new Error(t.error);if(!t.data)throw new Error("No data received");return t.data}async put(e,r){const t=await this.request(e,{method:"PUT",body:r?JSON.stringify(r):void 0});if(t.error)throw new Error(t.error);if(!t.data)throw new Error("No data received");return t.data}async delete(e){const r=await this.request(e,{method:"DELETE"});if(r.error)throw new Error(r.error);if(!r.data)throw new Error("No data received");return r.data}async patch(e,r){const t=await this.request(e,{method:"PATCH",body:r?JSON.stringify(r):void 0});if(t.error)throw new Error(t.error);if(!t.data)throw new Error("No data received");return t.data}async getProjects(e){const r=new URLSearchParams;e!=null&&e.search&&r.append("search",e.search),e!=null&&e.status&&r.append("status",e.status),e!=null&&e.environment&&r.append("environment",e.environment),e!=null&&e.tags&&e.tags.length>0&&r.append("tags",e.tags.join(","));const t=r.toString(),o=`/api/projects${t?`?${t}`:""}`,n=await this.request(o);if(n.error)throw console.error("Failed to fetch projects:",n.error),new Error(n.error);return n.data||[]}async getProject(e){const r=await this.request(`/api/projects/${e}`);if(r.error)throw new Error(r.error);if(!r.data)throw new Error("Project not found");return r.data}async createProject(e){const r=await this.request("/api/projects",{method:"POST",body:JSON.stringify(e)});if(r.error)throw new Error(r.error);if(!r.data)throw new Error("Failed to create project");return r.data}async updateProject(e,r){const t=await this.request(`/api/projects/${e}`,{method:"PATCH",body:JSON.stringify(r)});if(t.error)throw new Error(t.error);if(!t.data)throw new Error("Failed to update project");return t.data}async deleteProject(e){const r=await this.request(`/api/projects/${e}`,{method:"DELETE"});if(r.error)throw new Error(r.error)}async deployProject(e,r){const t=await this.request(`/api/projects/${e}/deploy`,{method:"POST",body:JSON.stringify({environment:r})});if(t.error)throw new Error(t.error);if(!t.data)throw new Error("Deployment failed");return t.data}async getProjectLogs(e,r=100){var o;const t=await this.request(`/api/projects/${e}/logs?limit=${r}`);return t.error?(console.warn("Failed to fetch logs:",t.error),[]):((o=t.data)==null?void 0:o.logs)||[]}async generateCode(e,r,t){const o=await this.request("/api/ai/generate",{method:"POST",body:JSON.stringify({requirements:e,language:r,framework:t})});if(o.error)throw new Error(o.error);if(!o.data)throw new Error("Code generation failed");return o.data}async runQA(e){const r=await this.request(`/api/projects/${e}/qa`,{method:"POST"});if(r.error)throw new Error(r.error);if(!r.data)throw new Error("QA execution failed");return r.data}async applyRefactoring(e,r){const t=await this.request(`/api/projects/${e}/refactor`,{method:"POST",body:JSON.stringify(r)});if(t.error)throw new Error(t.error);if(!t.data)throw new Error("Refactoring failed");return t.data}async analyzeProject(e){const r=await this.request(`/api/projects/${e}/analyze`,{method:"POST"});if(r.error)throw new Error(r.error);if(!r.data)throw new Error("Analysis failed");return r.data}connectWebSocket(e,r){const t=this.baseUrl.replace(/^http/,"ws")+"/ws";this.ws=new WebSocket(t),this.ws.onopen=()=>{var o;console.log("‚úÖ WebSocket connected"),this.apiKey&&((o=this.ws)==null||o.send(JSON.stringify({type:"auth",token:this.apiKey})))},this.ws.onmessage=e,this.ws.onerror=o=>{console.error("‚ùå WebSocket error:",o),r&&r(o)},this.ws.onclose=()=>{console.log("üîå WebSocket disconnected"),setTimeout(()=>{console.log("üîÑ Attempting WebSocket reconnection..."),this.connectWebSocket(e,r)},5e3)}}sendWebSocketMessage(e){this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify(e)):console.warn("‚ö†Ô∏è  WebSocket not connected")}disconnectWebSocket(){this.ws&&(this.ws.close(),this.ws=void 0)}async getAnalytics(e,r="7d"){const t=await this.request(`/api/analytics/${e}?range=${r}`);if(t.error)throw new Error(t.error);return t.data}async healthCheck(){try{return(await this.request("/health",{},0)).status===200}catch{return!1}}}let w=null;function P(s){return w||(w=new f({baseUrl:c.REACT_APP_API_URL||"http://localhost:8080",apiKey:c.REACT_APP_API_KEY})),w}export{P as g};
//# sourceMappingURL=api-client-D-NQVLVt.js.map
